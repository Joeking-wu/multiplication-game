<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10ä»¥å…§åŠ æ³•é€£ç·šéŠæˆ²</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .title {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .timer {
            color: #e74c3c;
        }
        
        .page-info {
            color: #3498db;
        }
        
        .score {
            color: #27ae60;
        }
        
        .game-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin: 30px 0;
            min-height: 400px;
        }
        
        .questions, .answers {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .question, .answer {
            padding: 15px 20px;
            border: 3px solid #ddd;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.4em;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .question {
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
        }
        
        .answer {
            background: linear-gradient(45deg, #ffeaea, #ffcccb);
        }
        .question:hover, .answer:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .question.selected {
            border-color: #3498db;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            transform: scale(1.05);
        }
        
        .answer.selected {
            border-color: #3498db;
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            transform: scale(1.05);
        }
        
        .correct {
            border-color: #27ae60 !important;
            background: linear-gradient(45deg, #27ae60, #2ecc71) !important;
            color: white !important;
            animation: pulse 0.5s ease-in-out;
        }
        
        .incorrect {
            border-color: #e74c3c !important;
            background: linear-gradient(45deg, #e74c3c, #c0392b) !important;
            color: white !important;
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .controls {
            text-align: center;
            margin: 30px 0;
        }
        
        .btn {
            padding: 12px 25px;
            margin: 0 10px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .name-input {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        
        .name-input input {
            padding: 10px 15px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin: 0 10px;
        }
        
        .leaderboard {
            margin-top: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
        }
        
        .leaderboard h3 {
            text-align: center;
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .leaderboard table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .leaderboard th, .leaderboard td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
        
        .leaderboard th {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            font-weight: bold;
        }
        
        .leaderboard tr:hover {
            background: #e9ecef;
        }
        
        .rank-1 { color: #f39c12; font-weight: bold; }
        .rank-2 { color: #95a5a6; font-weight: bold; }
        .rank-3 { color: #cd7f32; font-weight: bold; }
        
        .start-screen {
            text-align: center;
            padding: 50px 0;
        }
        
        .start-screen h2 {
            color: #333;
            margin-bottom: 20px;
        }
        
        .start-screen p {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ğŸ§® åŠ æ³•é€£ç·šéŠæˆ²</h1>
        </div>
        
        <div id="startScreen" class="start-screen">
            <h2>æ­¡è¿ä¾†åˆ°åŠ æ³•é€£ç·šéŠæˆ²ï¼</h2>
            <p>è«‹è¼¸å…¥æ‚¨çš„å§“åé–‹å§‹éŠæˆ²</p>
            <input type="text" id="playerName" placeholder="è«‹è¼¸å…¥å§“å" style="padding: 10px 15px; font-size: 1.1em; border: 2px solid #ddd; border-radius: 10px; margin: 0 10px;">
            <button class="btn btn-primary" onclick="startGame()">é–‹å§‹éŠæˆ²</button>
        </div>
        
        <div id="gameScreen" style="display: none;">
            <div class="game-info">
                <div class="timer">â° æ™‚é–“: <span id="timer">00:00</span></div>
                <div class="page-info">ğŸ“„ ç¬¬ <span id="currentPage">1</span> é  / å…± 3 é </div>
                <div class="score">âœ… ç­”å°: <span id="score">0</span> / 12</div>
            </div>
            
            <div class="game-area">
                <div class="questions" id="questions"></div>
                <div class="answers" id="answers"></div>
            </div>
            
            <div class="controls">
                <button class="btn btn-primary" id="prevBtn" onclick="previousPage()" disabled>ä¸Šä¸€é </button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextPage()">ä¸‹ä¸€é </button>
                <button class="btn btn-success" id="finishBtn" onclick="finishGame()" style="display: none;">å®ŒæˆéŠæˆ²</button>
            </div>
        </div>
        
        <div class="leaderboard">
            <h3>ğŸ† æ’è¡Œæ¦œ (å‰10å)</h3>
            <table>
                <thead>
                    <tr>
                        <th>æ’å</th>
                        <th>å§“å</th>
                        <th>ç­”å°é¡Œæ•¸</th>
                        <th>ç”¨æ™‚</th>
                    </tr>
                </thead>
                <tbody id="leaderboardBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
function generateGameData1() {
    const allQuestions = [];
    const totalQuestions = 12; // ç¸½é¡Œæ•¸
    const perGroup = 4;         // æ¯çµ„ä¸é‡è¤‡ç­”æ¡ˆçš„é¡Œæ•¸
    const maxNum = 9;           // æœ€å¤§æ•¸å­—
    const maxSum = 10;          // ç¸½å’Œä¸Šé™

    for (let group = 0; group < totalQuestions / perGroup; group++) {
        // å…ˆç”Ÿæˆæ‰€æœ‰åˆæ³•é¡Œç›®
        const candidates = [];
        for (let num1 = 1; num1 <= maxNum; num1++) {
            for (let num2 = 1; num2 <= maxNum; num2++) {
                if (num1 + num2 <= maxSum) {
                    candidates.push({
                        question: `${num1} + ${num2}`,
                        answer: num1 + num2
                    });
                }
            }
        }

        // æ´—ç‰Œï¼ˆFisher-Yates æ¼”ç®—æ³•ï¼‰
        for (let i = candidates.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [candidates[i], candidates[j]] = [candidates[j], candidates[i]];
        }

        // é¸å‡ºæœ¬çµ„ä¸é‡è¤‡ç­”æ¡ˆçš„é¡Œç›®
        const usedAnswers = new Set();
        for (let i = 0; i < candidates.length && usedAnswers.size < perGroup; i++) {
            const q = candidates[i];
            if (!usedAnswers.has(q.answer)) {
                allQuestions.push(q);
                usedAnswers.add(q.answer);
            }
        }
    }

    return allQuestions;
}
        // éš¨æ©Ÿç”ŸæˆéŠæˆ²æ•¸æ“š
        function generateGameData() {
            const gameData = [];
const allQuestions = generateGameData1();
            // åˆ†é…åˆ°ä¸‰é ï¼Œæ¯é 4é¡Œ
            for (let page = 0; page < 3; page++) {
                const startIndex = page * 4;
                const pageQuestions = [];
                const pageCorrectAnswers = [];
                const pageAllAnswers = [];
                
                // ç²å–ç•¶å‰é çš„4å€‹é¡Œç›®
                for (let i = 0; i < 4; i++) {
                    const questionData = allQuestions[startIndex + i];
                    pageQuestions.push(questionData.question);
                    pageCorrectAnswers.push(questionData.answer);
                }
                
                // æ·»åŠ æ­£ç¢ºç­”æ¡ˆåˆ°é¸é …ä¸­
                pageAllAnswers.push(...pageCorrectAnswers);
                
                // æ·»åŠ 2å€‹å¹²æ“¾é …ç­”æ¡ˆï¼ˆ10ä»¥å…§ä¸”ä¸èˆ‡æ­£ç¢ºç­”æ¡ˆé‡è¤‡ï¼‰
                const availableDistractors = [];
                for (let i = 2; i <= 10; i++) { // 2åˆ°10çš„æ•¸å­—ä½œç‚ºå¹²æ“¾é …
                    if (!pageCorrectAnswers.includes(i)) {
                        availableDistractors.push(i);
                    }
                }
                
                // éš¨æ©Ÿé¸æ“‡2å€‹å¹²æ“¾é …
                while (pageAllAnswers.length < 6 && availableDistractors.length > 0) {
                    const randomIndex = Math.floor(Math.random() * availableDistractors.length);
                    const distractor = availableDistractors.splice(randomIndex, 1)[0];
                    pageAllAnswers.push(distractor);
                }
                
                gameData.push({
                    questions: pageQuestions,
                    correctAnswers: pageCorrectAnswers,
                    allAnswers: pageAllAnswers
                });
            }
            
            return gameData;
        }
        
        let gameData = [];
        
        let currentPage = 0;
        let selectedQuestion = null;
        let selectedAnswer = null;
        let score = 0;
        let startTime = null;
        let timerInterval = null;
        let playerName = '';
        let pageAnswers = [[], [], []]; // è¨˜éŒ„æ¯é çš„ç­”é¡Œæƒ…æ³
        
        function startGame() {
            const nameInput = document.getElementById('playerName');
            if (!nameInput.value.trim()) {
                alert('è«‹è¼¸å…¥æ‚¨çš„å§“åï¼');
                return;
            }
            
            playerName = nameInput.value.trim();
            
            // ç”Ÿæˆéš¨æ©Ÿé¡Œç›®
            gameData = generateGameData();
            
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            
            startTime = Date.now();
            startTimer();
            loadPage(0);
        }
        
        function startTimer() {
            timerInterval = setInterval(function() {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('timer').textContent = 
                    String(minutes).padStart(2, '0') + ':' + String(seconds).padStart(2, '0');
            }, 1000);
        }
        
        function loadPage(pageIndex) {
            currentPage = pageIndex;
            const data = gameData[pageIndex];
            
            // æ›´æ–°é é¢ä¿¡æ¯
            document.getElementById('currentPage').textContent = pageIndex + 1;
            
            // æ¸…ç©ºé¸æ“‡
            selectedQuestion = null;
            selectedAnswer = null;
            
            // ç”Ÿæˆé¡Œç›®
            const questionsContainer = document.getElementById('questions');
            questionsContainer.innerHTML = '';
            data.questions.forEach((question, index) => {
                const div = document.createElement('div');
                div.className = 'question';
                div.textContent = question;
                div.onclick = () => selectQuestion(index);
                
                // æª¢æŸ¥æ˜¯å¦å·²ç¶“ç­”å°
                if (pageAnswers[pageIndex][index] === true) {
                    div.classList.add('correct');
                    div.onclick = null;
                }
                
                questionsContainer.appendChild(div);
            });
            
            // ç”Ÿæˆç­”æ¡ˆï¼ˆæ‰“äº‚é †åºï¼‰
            const answersContainer = document.getElementById('answers');
            answersContainer.innerHTML = '';
            const shuffledAnswers = [...data.allAnswers].sort(() => Math.random() - 0.5);
            shuffledAnswers.forEach((answer, index) => {
                const div = document.createElement('div');
                div.className = 'answer';
                div.textContent = answer;
                div.onclick = () => selectAnswer(answer);
                answersContainer.appendChild(div);
            });
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.getElementById('prevBtn').disabled = pageIndex === 0;
            document.getElementById('nextBtn').style.display = pageIndex === 2 ? 'none' : 'inline-block';
            document.getElementById('finishBtn').style.display = pageIndex === 2 ? 'inline-block' : 'none';
        }
        
        function selectQuestion(index) {
            // å¦‚æœå·²ç¶“ç­”å°ï¼Œä¸èƒ½é‡æ–°é¸æ“‡
            if (pageAnswers[currentPage][index] === true) return;
            
            // æ¸…é™¤ä¹‹å‰çš„é¸æ“‡
            document.querySelectorAll('.question').forEach(q => q.classList.remove('selected'));
            
            // é¸æ“‡ç•¶å‰é¡Œç›®
            selectedQuestion = index;
            document.querySelectorAll('.question')[index].classList.add('selected');
            
            // æ¸…é™¤ç­”æ¡ˆé¸æ“‡
            selectedAnswer = null;
            document.querySelectorAll('.answer').forEach(a => a.classList.remove('selected'));
        }
        
        function selectAnswer(answer) {
            // æ¸…é™¤ä¹‹å‰çš„é¸æ“‡
            document.querySelectorAll('.answer').forEach(a => a.classList.remove('selected'));
            
            // é¸æ“‡ç•¶å‰ç­”æ¡ˆ
            selectedAnswer = answer;
            document.querySelectorAll('.answer').forEach(a => {
                if (a.textContent == answer) {
                    a.classList.add('selected');
                }
            });
            
            // å¦‚æœå·²ç¶“é¸æ“‡äº†é¡Œç›®ï¼Œé€²è¡Œé…å°
            if (selectedQuestion !== null) {
                checkAnswer();
            }
        }
        
        function checkAnswer() {
            const correctAnswer = gameData[currentPage].correctAnswers[selectedQuestion];
            const questionElement = document.querySelectorAll('.question')[selectedQuestion];
            const answerElements = document.querySelectorAll('.answer');
            let selectedAnswerElement = null;
            
            answerElements.forEach(a => {
                if (a.textContent == selectedAnswer) {
                    selectedAnswerElement = a;
                }
            });
            
            if (selectedAnswer === correctAnswer) {
                // ç­”å°äº†
                questionElement.classList.remove('selected');
                questionElement.classList.add('correct');
                selectedAnswerElement.classList.remove('selected');
                selectedAnswerElement.classList.add('correct');
                
                // ç¦ç”¨å·²ç­”å°çš„é¡Œç›®å’Œç­”æ¡ˆ
                questionElement.onclick = null;
                selectedAnswerElement.onclick = null;
                
                // è¨˜éŒ„ç­”å°
                pageAnswers[currentPage][selectedQuestion] = true;
                score++;
                document.getElementById('score').textContent = score;
                
                // æª¢æŸ¥æ˜¯å¦å®Œæˆç•¶å‰é é¢æ‰€æœ‰é¡Œç›®
                const currentPageCorrect = pageAnswers[currentPage].filter(answer => answer === true).length;
                if (currentPageCorrect === 4) {
                    // å®Œæˆç•¶å‰é é¢ï¼Œè‡ªå‹•æ›åˆ°ä¸‹ä¸€é 
                    setTimeout(() => {
                        if (currentPage < 2) {
                            // é¡¯ç¤ºé é¢å®Œæˆæç¤º
                            const pageCompleteMsg = document.createElement('div');
                            pageCompleteMsg.style.cssText = `
                                position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                                background: linear-gradient(45deg, #27ae60, #2ecc71); color: white;
                                padding: 20px 40px; border-radius: 15px; font-size: 1.5em;
                                box-shadow: 0 10px 20px rgba(0,0,0,0.3); z-index: 1000;
                            `;
                            pageCompleteMsg.textContent = `ç¬¬${currentPage + 1}é å®Œæˆï¼å³å°‡é€²å…¥ä¸‹ä¸€é ...`;
                            document.body.appendChild(pageCompleteMsg);
                            
                            setTimeout(() => {
                                document.body.removeChild(pageCompleteMsg);
                                loadPage(currentPage + 1);
                            }, 1500);
                        } else {
                            // å®Œæˆæ‰€æœ‰é¡Œç›®
                            finishGame();
                        }
                    }, 500);
                }
                
            } else {
                // ç­”éŒ¯äº†
                questionElement.classList.add('incorrect');
                selectedAnswerElement.classList.add('incorrect');
                
                // è¨˜éŒ„ç­”éŒ¯
                pageAnswers[currentPage][selectedQuestion] = false;
                
                // 1ç§’å¾Œæ¢å¾©
                setTimeout(() => {
                    questionElement.classList.remove('incorrect', 'selected');
                    selectedAnswerElement.classList.remove('incorrect', 'selected');
                }, 1000);
            }
            
            // é‡ç½®é¸æ“‡
            selectedQuestion = null;
            selectedAnswer = null;
        }
        
        function previousPage() {
            if (currentPage > 0) {
                loadPage(currentPage - 1);
            }
        }
        
        function nextPage() {
            if (currentPage < 2) {
                loadPage(currentPage + 1);
            }
        }
        
        function finishGame() {
            clearInterval(timerInterval);
            const endTime = Date.now();
            const totalTime = Math.floor((endTime - startTime) / 1000);
            
            // ä¿å­˜æˆç¸¾
            saveScore(playerName, score, totalTime);
            
            // é¡¯ç¤ºçµæœ
            alert(`éŠæˆ²çµæŸï¼\nç­”å°é¡Œæ•¸: ${score}/12\nç”¨æ™‚: ${formatTime(totalTime)}`);
            
            // æ›´æ–°æ’è¡Œæ¦œ
            updateLeaderboard();
            
            // é‡ç½®éŠæˆ²
            resetGame();
        }
        
        function saveScore(name, correctAnswers, time) {
            let scores = JSON.parse(localStorage.getItem('mathGameScores') || '[]');
            scores.push({
                name: name,
                correct: correctAnswers,
                time: time,
                date: new Date().toLocaleDateString()
            });
            localStorage.setItem('mathGameScores', JSON.stringify(scores));
        }
        
        function updateLeaderboard() {
            let scores = JSON.parse(localStorage.getItem('mathGameScores') || '[]');
            
            // æ’åºï¼šå…ˆæŒ‰ç­”å°é¡Œæ•¸é™åºï¼Œå†æŒ‰æ™‚é–“å‡åº
            scores.sort((a, b) => {
                if (b.correct !== a.correct) {
                    return b.correct - a.correct;
                }
                return a.time - b.time;
            });
            
            // åªé¡¯ç¤ºå‰10å
            scores = scores.slice(0, 10);
            
            const tbody = document.getElementById('leaderboardBody');
            tbody.innerHTML = '';
            
            scores.forEach((score, index) => {
                const row = document.createElement('tr');
                let rankClass = '';
                if (index === 0) rankClass = 'rank-1';
                else if (index === 1) rankClass = 'rank-2';
                else if (index === 2) rankClass = 'rank-3';
                
                row.innerHTML = `
                    <td class="${rankClass}">${index + 1}</td>
                    <td>${score.name}</td>
                    <td>${score.correct}/12</td>
                    <td>${formatTime(score.time)}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return String(minutes).padStart(2, '0') + ':' + String(secs).padStart(2, '0');
        }
        
        function resetGame() {
            currentPage = 0;
            selectedQuestion = null;
            selectedAnswer = null;
            score = 0;
            pageAnswers = [[], [], []];
            gameData = []; // é‡ç½®éŠæˆ²æ•¸æ“šï¼Œä¸‹æ¬¡é–‹å§‹æ™‚æœƒé‡æ–°ç”Ÿæˆ
            document.getElementById('score').textContent = '0';
            document.getElementById('timer').textContent = '00:00';
            document.getElementById('playerName').value = '';
            
            document.getElementById('startScreen').style.display = 'block';
            document.getElementById('gameScreen').style.display = 'none';
        }
        
        // åˆå§‹åŒ–æ’è¡Œæ¦œ
        updateLeaderboard();
    </script>
</body>
</html>
